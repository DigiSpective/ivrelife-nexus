<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Comprehensive Debug Analysis</title>
    <style>
        body { font-family: 'Monaco', 'Menlo', monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; font-size: 14px; }
        .section { background: #2d2d30; padding: 20px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #007acc; }
        .success { border-left-color: #4ec9b0; }
        .error { border-left-color: #f44747; }
        .warning { border-left-color: #ffcc02; }
        .code { background: #1e1e1e; padding: 10px; border-radius: 4px; margin: 10px 0; font-family: inherit; white-space: pre-wrap; }
        h1, h2, h3 { color: #569cd6; }
        .test-result { margin: 5px 0; padding: 5px 10px; border-radius: 3px; }
        .pass { background: rgba(78, 201, 176, 0.2); color: #4ec9b0; }
        .fail { background: rgba(244, 71, 71, 0.2); color: #f44747; }
        .info { background: rgba(0, 122, 204, 0.2); color: #007acc; }
        button { background: #007acc; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a9e; }
    </style>
</head>
<body>
    <h1>üîç IV RELIFE Nexus - Comprehensive Debug Analysis</h1>
    <p>Complete diagnostic tool to identify the exact cause of the blank page issue.</p>
    
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        const tests = [];

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            tests.push({ message, type, timestamp: new Date().toISOString() });
            console.log(`[${type.toUpperCase()}] ${message.replace(/<[^>]*>/g, '')}`);
            
            // Update UI
            updateResults();
        }

        function updateResults() {
            const sections = {
                environment: [],
                network: [],
                modules: [],
                react: [],
                errors: []
            };

            tests.forEach(test => {
                if (test.message.includes('Environment') || test.message.includes('Browser') || test.message.includes('DOM')) {
                    sections.environment.push(test);
                } else if (test.message.includes('Fetch') || test.message.includes('Network') || test.message.includes('HTTP')) {
                    sections.network.push(test);
                } else if (test.message.includes('Module') || test.message.includes('Import')) {
                    sections.modules.push(test);
                } else if (test.message.includes('React') || test.message.includes('Component')) {
                    sections.react.push(test);
                } else if (test.type === 'fail') {
                    sections.errors.push(test);
                }
            });

            results.innerHTML = '';
            
            Object.entries(sections).forEach(([section, sectionTests]) => {
                if (sectionTests.length === 0) return;
                
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section';
                sectionDiv.innerHTML = `
                    <h3>üìä ${section.toUpperCase()} (${sectionTests.length} tests)</h3>
                    ${sectionTests.map(test => `<div class="test-result ${test.type}">${test.message}</div>`).join('')}
                `;
                results.appendChild(sectionDiv);
            });
        }

        // Test 1: Environment Analysis
        log('üåç Environment: Starting comprehensive analysis...', 'info');
        log(`üåç Environment: User Agent - ${navigator.userAgent}`, 'info');
        log(`üåç Environment: JavaScript enabled - ${typeof eval !== 'undefined'}`, 'pass');
        log(`üåç Environment: ES6 support - ${typeof Promise !== 'undefined'}`, 'pass');
        log(`üåç Environment: Module support - ${typeof import !== 'undefined'}`, typeof import !== 'undefined' ? 'pass' : 'fail');

        // Test 2: DOM Analysis
        log('üèóÔ∏è DOM: Checking document state...', 'info');
        log(`üèóÔ∏è DOM: Ready state - ${document.readyState}`, 'info');
        log(`üèóÔ∏è DOM: Root element exists - ${!!document.getElementById('root')}`, !!document.getElementById('root') ? 'pass' : 'fail');

        // Test 3: Network Tests
        log('üì° Network: Testing script accessibility...', 'info');
        
        fetch('/src/main.tsx')
            .then(response => {
                log(`üì° Network: Main script status - ${response.status} ${response.statusText}`, response.ok ? 'pass' : 'fail');
                log(`üì° Network: Content-Type - ${response.headers.get('content-type')}`, 'info');
                return response.text();
            })
            .then(content => {
                log(`üì° Network: Script length - ${content.length} bytes`, content.length > 0 ? 'pass' : 'fail');
                log(`üì° Network: Contains React imports - ${content.includes('react')}`, content.includes('react') ? 'pass' : 'fail');
                log(`üì° Network: Contains console.log - ${content.includes('console.log')}`, content.includes('console.log') ? 'pass' : 'fail');
            })
            .catch(error => {
                log(`üì° Network: Fetch failed - ${error.message}`, 'fail');
            });

        // Test 4: Module Loading
        log('üì¶ Module: Testing import functionality...', 'info');
        
        // Test inline module
        const testInlineModule = () => {
            try {
                const script = document.createElement('script');
                script.type = 'module';
                script.textContent = `
                    console.log('üì¶ Module: Inline module test executing');
                    window.inlineModuleWorking = true;
                `;
                document.head.appendChild(script);
                
                setTimeout(() => {
                    log(`üì¶ Module: Inline module execution - ${!!window.inlineModuleWorking}`, window.inlineModuleWorking ? 'pass' : 'fail');
                }, 100);
            } catch (error) {
                log(`üì¶ Module: Inline module failed - ${error.message}`, 'fail');
            }
        };
        testInlineModule();

        // Test 5: React CDN Loading
        log('‚öõÔ∏è React: Testing CDN loading...', 'info');
        
        const script1 = document.createElement('script');
        script1.src = 'https://unpkg.com/react@18/umd/react.development.js';
        script1.onload = () => {
            log('‚öõÔ∏è React: CDN React loaded', 'pass');
            
            const script2 = document.createElement('script');
            script2.src = 'https://unpkg.com/react-dom@18/umd/react-dom.development.js';
            script2.onload = () => {
                log('‚öõÔ∏è React: CDN ReactDOM loaded', 'pass');
                
                // Test React functionality
                if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined') {
                    try {
                        const testContainer = document.createElement('div');
                        testContainer.id = 'react-test';
                        document.body.appendChild(testContainer);
                        
                        const root = ReactDOM.createRoot(testContainer);
                        const element = React.createElement('div', { 
                            style: { 
                                background: '#4ec9b0', 
                                color: 'white', 
                                padding: '10px', 
                                borderRadius: '4px',
                                margin: '10px 0'
                            }
                        }, '‚úÖ CDN React Successfully Rendering!');
                        
                        root.render(element);
                        log('‚öõÔ∏è React: CDN rendering successful', 'pass');
                    } catch (error) {
                        log(`‚öõÔ∏è React: CDN rendering failed - ${error.message}`, 'fail');
                    }
                }
            };
            script2.onerror = () => log('‚öõÔ∏è React: CDN ReactDOM load failed', 'fail');
            document.head.appendChild(script2);
        };
        script1.onerror = () => log('‚öõÔ∏è React: CDN React load failed', 'fail');
        document.head.appendChild(script1);

        // Test 6: Error Monitoring
        window.addEventListener('error', (event) => {
            log(`üö® Error: Global - ${event.message} at ${event.filename}:${event.lineno}`, 'fail');
        });

        window.addEventListener('unhandledrejection', (event) => {
            log(`üö® Error: Unhandled Promise - ${event.reason}`, 'fail');
        });

        // Test 7: Security Policies
        log('üîí Security: Checking CSP and policies...', 'info');
        const csp = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
        log(`üîí Security: CSP meta tag - ${!!csp}`, csp ? 'info' : 'pass');

        // Test 8: Manual Module Test
        const testManualModule = () => {
            log('üß™ Manual: Testing manual module loading...', 'info');
            
            const script = document.createElement('script');
            script.type = 'module';
            script.textContent = `
                try {
                    console.log('üß™ Manual: Module script executing');
                    const testImport = await import('data:text/javascript,export default "test"');
                    console.log('üß™ Manual: Dynamic import working:', testImport.default);
                    window.manualModuleWorking = true;
                } catch (error) {
                    console.error('üß™ Manual: Module test failed:', error);
                    window.manualModuleError = error.message;
                }
            `;
            document.head.appendChild(script);
            
            setTimeout(() => {
                if (window.manualModuleWorking) {
                    log('üß™ Manual: Module loading successful', 'pass');
                } else if (window.manualModuleError) {
                    log(`üß™ Manual: Module loading failed - ${window.manualModuleError}`, 'fail');
                } else {
                    log('üß™ Manual: Module loading - no response (likely blocked)', 'fail');
                }
            }, 1000);
        };
        
        setTimeout(testManualModule, 500);

        // Generate Report
        setTimeout(() => {
            const failedTests = tests.filter(t => t.type === 'fail').length;
            const passedTests = tests.filter(t => t.type === 'pass').length;
            
            const reportDiv = document.createElement('div');
            reportDiv.className = failedTests > 0 ? 'section error' : 'section success';
            reportDiv.innerHTML = `
                <h3>üìã Final Analysis Report</h3>
                <div class="test-result info">Total Tests: ${tests.length}</div>
                <div class="test-result pass">Passed: ${passedTests}</div>
                <div class="test-result fail">Failed: ${failedTests}</div>
                <div class="code">
// Conclusion:
${failedTests === 0 ? 
    '‚úÖ ALL TESTS PASSED - The issue is likely in specific component dependencies' : 
    `‚ùå ${failedTests} CRITICAL ISSUES IDENTIFIED - Check failed tests above`}

// Next Steps:
${failedTests === 0 ? 
    '1. All core systems working - investigate specific React components\n2. Check browser console for component-specific errors\n3. Test individual page components' :
    '1. Address failed core system tests first\n2. Focus on module loading or React CDN issues\n3. Check browser security settings'}
                </div>
                <button onclick="window.location.reload()">üîÑ Rerun Tests</button>
                <button onclick="navigator.clipboard.writeText(JSON.stringify(tests, null, 2))">üìã Copy Results</button>
            `;
            results.appendChild(reportDiv);
        }, 5000);
    </script>
</body>
</html>