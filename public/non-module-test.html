<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Non-Module Loading Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .status { padding: 15px; margin: 10px 0; border-radius: 5px; border: 1px solid; }
        .success { background: #d4edda; color: #155724; border-color: #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border-color: #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border-color: #bee5eb; }
    </style>
</head>
<body>
    <h1>üß™ Non-Module Script Loading Test</h1>
    <p>Testing React application loading without ES6 modules</p>
    
    <div id="status"></div>
    <div id="react-app"></div>

    <!-- Load React from CDN first -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script>
        const status = document.getElementById('status');
        const appContainer = document.getElementById('react-app');
        
        function updateStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            status.appendChild(div);
            console.log(message.replace(/<[^>]*>/g, ''));
        }
        
        updateStatus('üöÄ Starting non-module loading test...', 'info');
        
        // Test React availability
        if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined') {
            updateStatus('‚úÖ React and ReactDOM loaded from CDN', 'success');
            
            // Create a simple React app without modules
            const { createElement: e, useState } = React;
            const { createRoot } = ReactDOM;
            
            function TestApp() {
                const [count, setCount] = useState(0);
                const [loadingStage, setLoadingStage] = useState(1);
                
                React.useEffect(() => {
                    // Simulate loading stages
                    const timer = setInterval(() => {
                        setLoadingStage(prev => {
                            if (prev >= 5) {
                                clearInterval(timer);
                                return prev;
                            }
                            return prev + 1;
                        });
                    }, 1000);
                    
                    return () => clearInterval(timer);
                }, []);
                
                return e('div', {
                    style: { 
                        padding: '30px', 
                        background: 'white', 
                        borderRadius: '8px', 
                        boxShadow: '0 2px 10px rgba(0,0,0,0.1)' 
                    }
                }, [
                    e('h2', { key: 'title' }, 'üéâ React App Working (Non-Module)'),
                    e('div', { key: 'progress', style: { margin: '20px 0' } }, [
                        e('p', { key: 'stage' }, `Loading Stage: ${loadingStage}/5`),
                        e('div', { 
                            key: 'bar',
                            style: { 
                                background: '#ddd', 
                                height: '10px', 
                                borderRadius: '5px',
                                overflow: 'hidden'
                            }
                        }, e('div', {
                            style: {
                                background: '#4caf50',
                                height: '100%',
                                width: `${(loadingStage / 5) * 100}%`,
                                transition: 'width 0.5s ease'
                            }
                        }))
                    ]),
                    e('div', { key: 'counter', style: { margin: '20px 0' } }, [
                        e('p', { key: 'count' }, `Counter: ${count}`),
                        e('button', {
                            key: 'btn',
                            onClick: () => setCount(count + 1),
                            style: {
                                padding: '10px 20px',
                                background: '#007bff',
                                color: 'white',
                                border: 'none',
                                borderRadius: '5px',
                                cursor: 'pointer'
                            }
                        }, 'Increment')
                    ]),
                    loadingStage >= 5 && e('div', { 
                        key: 'complete',
                        style: { 
                            background: '#d4edda', 
                            padding: '15px', 
                            borderRadius: '5px',
                            color: '#155724'
                        }
                    }, '‚úÖ Non-module loading successful! This proves React works without ES6 modules.')
                ]);
            }
            
            try {
                const root = createRoot(appContainer);
                root.render(e(TestApp));
                updateStatus('‚úÖ React app rendered successfully using non-module approach', 'success');
            } catch (error) {
                updateStatus(`‚ùå React rendering failed: ${error.message}`, 'error');
            }
            
        } else {
            updateStatus('‚ùå React or ReactDOM not available from CDN', 'error');
        }
        
        // Test fetch to main compiled script
        updateStatus('üì° Testing fetch to compiled main.tsx...', 'info');
        fetch('/src/main.tsx')
            .then(response => {
                updateStatus(`üì¶ Main script response: ${response.status} ${response.statusText}`, 
                    response.ok ? 'success' : 'error');
                return response.text();
            })
            .then(content => {
                updateStatus(`üìÑ Script length: ${content.length} characters`, 'info');
                if (content.length > 0) {
                    updateStatus('‚úÖ Main script content is accessible and non-empty', 'success');
                } else {
                    updateStatus('‚ùå Main script content is empty', 'error');
                }
            })
            .catch(error => {
                updateStatus(`‚ùå Fetch failed: ${error.message}`, 'error');
            });
    </script>
</body>
</html>